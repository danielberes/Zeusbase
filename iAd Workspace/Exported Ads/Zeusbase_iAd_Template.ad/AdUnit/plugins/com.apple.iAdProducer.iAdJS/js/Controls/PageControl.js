
/**
*
* Copyright Â© 2009-2011 Apple Inc.  All rights reserved.
*
**/

iAd.Class({name:"iAd.PageControl",superclass:iAd.Control,synthesizedProperties:["currentPage","numberOfPages","hidesForSinglePage"],archivedProperties:["numberOfPages","currentPage","hidesForSinglePage","defersCurrentPageDisplay"],cssClassName:"ad-page-control",collectionAccessor:"pageControls"});iAd.PageControl.DEFAULT_SIZE=6;iAd.PageControl.MARGIN=10;iAd.PageControl.SELECTED_CSS="ad-selected";iAd.PageControl.prototype.init=function(a){this.dots=[];this.defersCurrentPageDisplay=false;this._currentPage=0;this._numberOfPages=0;this._hidesForSinglePage=false;this.callSuper(a);this.addEventListener(iAd.View.ACTIVATE_EVENT,this,false)};iAd.PageControl.prototype.setSize=function(a){a.width=Math.max(a.width,iAd.PageControl.DEFAULT_SIZE);a.height=Math.max(a.height,iAd.PageControl.DEFAULT_SIZE);this.callSuper(a);this.updateLayout()};iAd.PageControl.prototype.setCurrentPage=function(a){if(this._currentPage==a||a<0||a>=this.numberOfPages){return}this._currentPage=a;if(!this.defersCurrentPageDisplay){this.updateCurrentPageDisplay()}this.createAndDispatchEvent(iAd.Control.VALUE_CHANGE_EVENT)};iAd.PageControl.prototype.setNumberOfPages=function(a){if(this._numberOfPages==a||a<0){return}if(this.dots.length>a){while(this.dots.length>a){this.layer.removeChild(this.dots.pop())}}else{while(this.dots.length<a){this.dots.push(this.layer.appendChild(document.createElement("div")))}}this._numberOfPages=a;this.updateCurrentPageDisplay();this.updateLayout();this.updateVisibility()};iAd.PageControl.prototype.setHidesForSinglePage=function(a){this._hidesForSinglePage=a;this.updateVisibility()};iAd.PageControl.prototype.updateCurrentPageDisplay=function(){var a=this.layer.querySelector("."+iAd.PageControl.SELECTED_CSS);if(a){a.removeClassName(iAd.PageControl.SELECTED_CSS)}if(this.currentPage>=0&&this.currentPage<this.dots.length){this.dots[this.currentPage].addClassName(iAd.PageControl.SELECTED_CSS)}};iAd.PageControl.prototype.sizeForNumberOfPages=function(a){return a*(iAd.PageControl.DEFAULT_SIZE+iAd.PageControl.MARGIN)};iAd.PageControl.prototype.updateLayout=function(a){var b=Math.max(0,(this.size.width-this.sizeForNumberOfPages(this._numberOfPages))/2);this.setLayerStyle({"padding-left":b+"px","padding-top":((this.size.height-iAd.PageControl.DEFAULT_SIZE)/2)+"px"})};iAd.PageControl.prototype.updateVisibility=function(){this.setLayerStyle({visibility:(this.numberOfPages==1&&this.hidesForSinglePage)?"hidden":"visible"})};iAd.PageControl.prototype.handleEvent=function(c){this.callSuper(c);if(this.numberOfPages<=1){return}if(c.type==iAd.View.ACTIVATE_EVENT&&c.ad.originalEvent.type==iAd.Event.END_EVENT){c=c.ad.originalEvent;var b=iAd.Point.fromEventInElement(c,this.layer).x;var a=this.dots[this.currentPage].offsetLeft;if(b<=a-iAd.PageControl.MARGIN/2){this.currentPage--}else{if(b>=a+iAd.PageControl.DEFAULT_SIZE+iAd.PageControl.MARGIN/2){this.currentPage++}}}else{if(c.type==iAd.View.ACTIVATE_EVENT){this.currentPage=(this.numberOfPages+(this.currentPage+1)%this.numberOfPages)%this.numberOfPages}}};