
/**
*
* Copyright Â© 2009-2011 Apple Inc.  All rights reserved.
*
**/

iAd.Class({name:"iAP.VideoPlayerAction",superclass:iAP.MediaPlayerAction});iAP.VideoPlayerAction.prototype.prepare=function(){iAd.Utils.archiveOriginalValue(this.targetView,"media")};iAP.VideoPlayerAction.prototype.reset=function(){this.callSuper();this.targetView.posterImageVisible=true};iAP.VideoPlayerAction.prototype.summaryText=function(){switch(this.methodName){case iAP.MediaPlayerAction.PLAY:return"Play";case iAP.MediaPlayerAction.PAUSE:return"Pause";case iAP.MediaPlayerAction.TOGGLE:return"Toggle";default:return"Video"}};iAP.VideoPlayerAction.prototype.renderSnapshot=function(b){if(this.methodName!=iAP.MediaPlayerAction.PLAY){return}if(this.elapsedTime>=this.duration+this.delay){return}var c=this.targetView;if(b[this.targetViewId].media==null){iAd.Utils.restoreOriginalValue(c,"media")}if(c.media){c.play();c.callMethodNameAfterDelay("pause",0);var a=(this.elapsedTime-this.delay)/this.duration*c.media.duration;if(isNaN(a)){return}c.seekToTime(a)}};iAP.VideoPlayerAction.prototype.addEventListeners=function(){this.callSuper();this.targetView.addEventListener(iAd.VideoPlayer.DID_CHANGE_FULLSCREEN,this,false)};iAP.VideoPlayerAction.prototype.removeEventListeners=function(){this.callSuper();this.targetView.removeEventListener(iAd.VideoPlayer.DID_CHANGE_FULLSCREEN,this,false)};iAP.VideoPlayerAction.prototype.handleEvent=function(b){var c=this.targetView;if(b.ad.sender!=c){return}var a=b.type;if(a==iAd.VideoPlayer.DID_CHANGE_FULLSCREEN){this.handleVideoDidChangeFullscreen(c,b.ad.fullscreen);return}if(!c.isFullscreen()&&(a==iAd.MediaPlayer.PLAYBACK_DID_PAUSE||a==iAd.MediaPlayer.PLAYBACK_DID_END)){this.end()}};iAP.VideoPlayerAction.prototype.handleVideoDidChangeFullscreen=function(b,a){if(!a&&b.playbackState!=iAd.Media.PLAYBACK_STATE_PLAYING){if(iAd.Device.iOSVersionLessThan("5.0")){this.callMethodNameAfterDelay("end",500)}else{this.end()}}};