
/**
*
* Copyright Â© 2009-2011 Apple Inc.  All rights reserved.
*
**/

iAd.Class({name:"iAP.EventDelegate",superclass:iAd.Object,synthesizedProperties:["eventHandlers","target","userScriptFunction","executionContext"]});iAP.EventDelegate.prototype.init=function(c,b,a){this.renamedEvents={};this.renamedEvents.flipViewDidFlip="containerDidFocusCellAtIndex";this.renamedEvents.audioButtonDidPlay="mediaDidPlay";this.renamedEvents.audioButtonDidPause="mediaDidPause";this.renamedEvents.audioButtonDidEnd="mediaDidEnd";this.renamedEvents.audioButtonDidTimeUpdate="mediaDidTimeUpdate";this.renamedEvents.didReceiveResponseData="mapViewDidReceiveResponseData";this.renamedEvents.didReceiveDataFailure="mapViewDidReceiveDataFailure";this.renamedEvents.annotationCalloutTapped="mapViewAnnotationLeftCalloutTapped";this.renamedEvents.mapViewDidTapAnnotationCallout="mapViewAnnotationLeftCalloutTapped";if(iAd.VideoPlayer&&c instanceof iAd.VideoPlayer){this.renamedEvents.mediaDidPlay="mediaPlaybackDidStart";this.renamedEvents.mediaDidPause="mediaPlaybackDidPause";this.renamedEvents.mediaDidEnd="mediaPlaybackDidEnd";this.renamedEvents.mediaDidTimeUpdate="mediaPlaybackDidProgress";this.renamedEvents.mediaDidEnterWaitingState="mediaPlaybackDidBeginWaiting";this.renamedEvents.mediaDidExitWaitingState="mediaPlaybackDidEndWaiting"}if(iAP.AudioButton&&c instanceof iAP.AudioButton){this.renamedEvents.audioButtonDidPlay="mediaPlaybackDidStart";this.renamedEvents.audioButtonDidPause="mediaPlaybackDidPause";this.renamedEvents.audioButtonDidEnd="mediaPlaybackDidEnd";this.renamedEvents.audioButtonDidTimeUpdate="mediaDidUpdateTime";this.renamedEvents.mediaDidPlay="mediaPlaybackDidStart";this.renamedEvents.mediaDidPause="mediaPlaybackDidPause";this.renamedEvents.mediaDidEnd="mediaPlaybackDidEnd";this.renamedEvents.mediaDidTimeUpdate="mediaDidUpdateTime"}if(iAP.RootViewController&&c instanceof iAP.RootViewController){this.renamedEvents.adDidFinishLaunching="didFinishLaunching";this.renamedEvents.adWillBeDismissed="willBeDismissed"}this.renamedEvents.galleryViewDidSelectCell="containerDidFocusCellAtIndex";this.renamedEvents.carouselViewDidChangeIndex="containerDidFocusCellAtIndex";this.callSuper();this._target=c;this._executionContext=b;this._userScriptFunction=a;this._eventHandlers={};if(b==null){this._executionContext=this}};iAP.EventDelegate.prototype.processUserScript=function(){for(var b in this.eventHandlers){var d=this.eventHandlers[b];this.target.removeEventListener(b,this,false);this.executionContext["on"+b.substr(0,1).toUpperCase()+b.substr(1)]=null}this._eventHandlers={};var a=this.executionContext.handleEvent;this.userScriptFunction.call(this.executionContext);if(this.executionContext.handleEvent!==a){var c=this.executionContext;var f=this.executionContext.handleEvent;var e=function(h){a.apply(c,[h]);f.apply(c,[h])};this.executionContext.handleEvent=e}for(key in this.executionContext){if(key.substr(0,2)!="on"){continue}var g=this.executionContext[key];if(typeof g=="function"){b=key.substr(2,1).toLowerCase()+key.substr(3);if(this.renamedEvents[b]){b=this.renamedEvents[b]}this.target.addEventListener(b,this,false);this.eventHandlers[b]=g}}};iAP.EventDelegate.prototype.handleEvent=function(b){var a=this.eventHandlers[b.type];if(a!=null&&b.ad&&b.ad.sender===this.target){if(b["arguments"]){a.apply(this.executionContext,b["arguments"])}else{a.call(this.executionContext,b)}}};iAP.EventDelegate.viewScriptFunctions={};iAP.EventDelegate.viewControllerScriptFunctions={};iAP.EventDelegate.registerViewControllerEventDelegate=function(b,a){iAP.EventDelegate.viewControllerScriptFunctions[b]=a};iAP.EventDelegate.registerViewEventDelegate=function(b,c,a){if(iAP.EventDelegate.viewScriptFunctions[c]==null){iAP.EventDelegate.viewScriptFunctions[c]={}}iAP.EventDelegate.viewScriptFunctions[c][b]=a};